"use strict";exports.id=338,exports.ids=[338],exports.modules={8338:(a,b,c)=>{c.r(b),c.d(b,{default:()=>d});let d={id:"materialize.repo",phase:"integrate",async run(a,b){let c=(a?.files??[]).filter(a=>a.startsWith("repo/")),d=a?.runId?`/${a.runId}`:"",e=c.map(a=>{let c,e=((c=(c=(c=(c=`artifacts/${b.orchestrationId}${d}/${a}`.replace(/^artifacts\/+/,"").replace(/\\/g,"/").trim()).replace(/^\/+|\/+$/g,"")).split("/").filter(a=>"."!==a&&".."!==a&&""!==a).join("/")).split("/").map(a=>a.replace(/\s+/g,"-").replace(/[\[\]\?#&<>:"%\\{}|\^~`]/g,"_")).join("/"))||(c="artifact"),c.length>900&&(c=c.slice(0,900)),c);return{originalPath:a,storageKey:e}}),f={orchestrationId:b.orchestrationId,runId:a?.runId??null,files:e},g=`artifacts/${b.orchestrationId}${d}/manifest.json`;return await b.storage.saveArtifact(g,function(a){let b=new WeakSet,c=a=>{if(null===a||"object"!=typeof a||b.has(a))return a;if(b.add(a),Array.isArray(a))return a.map(c);let d={};for(let b of Object.keys(a).sort())d[b]=c(a[b]);return d};return JSON.stringify(c(a),null,2)+"\n"}(f)),b.logger.info({msg:"materialize.repo:manifest_written",path:g,count:e.length}),{manifestPath:g,count:e.length}}}}};